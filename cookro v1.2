Global $Pause = 0
Global $p = 0

Opt("MouseCoordMode",2)
Opt("PixelCoordMode",2)
Opt("MouseClickDelay",0)

MsgBox(0,"매크로 v1.2","쿠키런카카오 코인 손크로 (by. ydy)"&@crlf&@crlf&"F1 : Run"&@crlf&"F2 : Pause"&@crlf&"F3 : Exit")

HotKeySet("{F1}","a")
HotKeySet("{F2}","b")
HotKeySet("{F3}","c")

While 1
WEnd

Func a()
	WinMove("LDPlayer", "", 0, 0, 700, 405, 1)
	Sleep(200)
	
	WinActivate("LDPlayer")
	WinWaitActive("LDPlayer")
	
	While 1
		While PixelGetColor(363, 159) <> 0xEEE9DF
			If PixelGetColor(326, 55) = 0x3197A2 Then
				Sleep(700)
				MouseClick("left", 257 + Random(0, 143, 1), 339 + Random(0, 48, 1), 1, 0)
				Sleep(1700)
				MouseClick("left", 257 + Random(0, 143, 1), 339 + Random(0, 48, 1), 1, 0)
				Sleep(1500)
			EndIf
			If PixelGetColor(322, 118) = 0xFFE700 Then
				Sleep(700)
				MouseClick("left", 257 + Random(0, 143, 1), 339 + Random(0, 48, 1), 1, 0)
				Sleep(1500)
			EndIf
			If PixelGetColor(200, 123) = 0x1C9AB5 Then
				Sleep(500)
				MouseClick("left", 257 + Random(0, 143, 1), 245 + Random(0, 48, 1), 1, 0)
				Sleep(500)
			EndIf
			If PixelGetColor(98, 374) = 0xC2C1B9 Then
				Sleep(2000)
				MouseClick("left", 279 + Random(0, 99, 1), 355 + Random(0, 32, 1), 1, 0)
				Sleep(500)
				MouseClick("left", 257 + Random(0, 140, 1), 302 + Random(0, 48, 1), 1, 0)
				Sleep(500)
			EndIf
		WEnd
		
		If PixelGetColor(553, 247) <> 0xFFFAEC Then
			MsgBox(0, "매크로", "이어달리기가 버터크림으로 설정되지 않았습니다")
			c()
		EndIf
		
		MouseClick("left", 386 + Random(0, 180, 1), 342 + Random(0, 31, 1), 1, 0)
		
		While PixelGetColor(273, 204) <> 0xE9E8E0
		WEnd
		
		Sleep(500)
		MouseClick("left", 160 + Random(0, 72, 1), 304 + Random(0, 72, 1), 1, 0)
		Sleep(300)
		MouseClick("left", 446 + Random(0, 120, 1), 163 + Random(0, 40, 1), 1, 0)
		Sleep(1000)
		
		While PixelGetColor(320, 50) <> 0xCDDDDD
			MouseClick("left", 386 + Random(0, 180, 1), 342 + Random(0, 31, 1), 1, 0)
			Sleep(500)
		WEnd
		
		Sleep(3500)
		While PixelGetColor(296, 210) <> 0xECFF00
			MouseMove(7 + Random(0, 110, 1), 316 + Random(0, 80, 1), 0)
			MouseDown("left")
			Sleep(231)
			MouseUp("left")
			Sleep(206)
			If Not Random(0, 14, 1) Then
				MouseMove(541 + Random(0, 110, 1), 316 + Random(0, 80, 1), 0)
				MouseDown("left")
				Sleep(500)
				MouseUp("left")
				Sleep(300)
			EndIf
		WEnd
		
		MouseClick("left", 296 + Random(0, 79, 1), 171 + Random(0, 79, 1), 1, 0)
		Sleep(2500)
		MouseClick("left", 623 + Random(0, 25, 1), 40 + Random(0, 25, 1), 1, 0)
		Sleep(300)
		MouseClick("left", 243 + Random(0, 58, 1), 229 + Random(0, 46, 1), 1, 0)
		Sleep(300)
		MouseClick("left", 243 + Random(0, 58, 1), 205 + Random(0, 46, 1), 1, 0)
		
		While PixelGetColor(100, 40) <> 0x1C9AB5
		WEnd
		Sleep(500)
		MouseClick("left", 158 + Random(0, 158, 1), 339 + Random(0, 47, 1), 1, 0)
		
		If PixelGetColor(100, 40) = 0x1C9AB5 Then
			MouseClick("left", 158 + Random(0, 158, 1), 339 + Random(0, 47, 1), 1, 0)
			Sleep(1000)
		EndIf
	WEnd
EndFunc

Func b()
	$Pause = Not $Pause
	While $Pause
	WEnd
EndFunc

Func c()
	MsgBox(0, "매크로", "매크로를 종료합니다")
	Exit
EndFunc
